function pdot=Puma_costateder(p,z,taud)

q1=z(1);
q2=z(2);
q3=z(3);
q1dot=z(4);
q2dot=z(5);
q3dot=z(6);

p1=p(1);
p2=p(2);
p3=p(3);
p4=p(4);
p5=p(5);
p6=p(6);

taud1=taud(1);
taud2=taud(2);
taud3=taud(3);

TH0=2.8123;
TH1=2.2623;
TH2=-0.0066;
TH3=0.3453;
TH4=-0.085;
TH5=8.8038;
TH6=1.0711;
TH7=-0.9748;
TH8=6.8067;
TH9=55.35;

Bemf=([38.7871;114.0474;28.5225]);
Bemf1=Bemf(1);
Bemf2=Bemf(2);
Bemf3=Bemf(3);


pdot(1,1)=0;
pdot(2,1)=p6*(((TH4*TH6*cos(q2 + q3) - TH4*TH5*cos(q2 + q3) + TH6*TH7*cos(q2) - TH3*TH4*cos(q2 + q3)*cos(q3) + TH3*TH7*cos(q2)*cos(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH8*sin(q2 + q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) - TH3*q1dot^2*sin(q2 + q3)*sin(q2) + TH3*q1dot^2*cos(q2 + q3)*cos(q2))*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(TH4*q2dot^2*sin(q2 + q3) + TH4*q3dot^2*sin(q2 + q3) + TH7*q2dot^2*sin(q2) + 2*TH4*q2dot*q3dot*sin(q2 + q3) + 4*TH3*q1dot*q2dot*cos(2*q2 + q3) + 2*TH3*q1dot*q3dot*cos(2*q2 + q3) + 2*TH1*q1dot*q2dot*cos(2*q2) + 2*TH2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*q1dot*q3dot*cos(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH8*sin(q2 + q3) + TH9*sin(q2) + 2*TH3*q1dot^2*cos(2*q2 + q3) + TH1*q1dot^2*cos(2*q2) + TH2*q1dot^2*cos(2*q2 + 2*q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH5*cos(q2 + q3)*sin(q2 + q3) + 4*TH3^2*cos(q2 + q3)*cos(q3)*sin(q2) + 4*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*sin(q2) + 2*TH3*TH5*sin(q2 + q3)*cos(q2) + 2*TH4*TH7*cos(q2 + q3)*sin(q2) + 2*TH4*TH7*sin(q2 + q3)*cos(q2) + 2*TH1*TH5*cos(q2)*sin(q2) + 4*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3) + 4*TH1*TH3*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^2*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*sin(q2) + 2*TH3*TH6*sin(q2 + q3)*cos(q2) + TH4*TH7*cos(q2 + q3)*sin(q2) + TH4*TH7*sin(q2 + q3)*cos(q2) + 2*TH1*TH6*cos(q2)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3) + 2*TH1*TH3*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 + ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 - ((taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2) - p5*(((TH6*TH7*cos(q2) - TH3*TH4*cos(q2 + q3)*cos(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(TH4*q2dot^2*sin(q2 + q3) + TH4*q3dot^2*sin(q2 + q3) + TH7*q2dot^2*sin(q2) + 2*TH4*q2dot*q3dot*sin(q2 + q3) + 4*TH3*q1dot*q2dot*cos(2*q2 + q3) + 2*TH3*q1dot*q3dot*cos(2*q2 + q3) + 2*TH1*q1dot*q2dot*cos(2*q2) + 2*TH2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*q1dot*q3dot*cos(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2))*(TH8*sin(q2 + q3) + TH9*sin(q2) + 2*TH3*q1dot^2*cos(2*q2 + q3) + TH1*q1dot^2*cos(2*q2) + TH2*q1dot^2*cos(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^2*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*sin(q2) + 2*TH3*TH6*sin(q2 + q3)*cos(q2) + TH4*TH7*cos(q2 + q3)*sin(q2) + TH4*TH7*sin(q2 + q3)*cos(q2) + 2*TH1*TH6*cos(q2)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3) + 2*TH1*TH3*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH8*sin(q2 + q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) - TH3*q1dot^2*sin(q2 + q3)*sin(q2) + TH3*q1dot^2*cos(q2 + q3)*cos(q2))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3*TH6*cos(q2 + q3)*sin(q2) + 2*TH3*TH6*sin(q2 + q3)*cos(q2) + 2*TH1*TH6*cos(q2)*sin(q2))*(taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 - ((TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2))*(taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 + ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2))*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2) - (p4*(TH6^2*TH7*q2dot^2*sin(q2) + TH4*TH5*taud3*cos(q2 + q3) - TH4*TH6*taud3*cos(q2 + q3) + TH6*TH7*taud2*cos(q2) - TH6*TH7*taud3*cos(q2) + TH6*TH7*TH9*cos(2*q2) + TH4*TH5*TH8*cos(2*q2 + 2*q3) - TH4*TH6*TH8*cos(2*q2 + 2*q3) + TH4*TH6^2*q2dot^2*sin(q2 + q3) + TH4*TH6^2*q3dot^2*sin(q2 + q3) - TH5*TH6*TH7*q2dot^2*sin(q2) + TH3^2*TH4*q2dot^2*sin(q2 + q3)*cos(q3)^2 + TH3^2*TH4*q3dot^2*sin(q2 + q3)*cos(q3)^2 - TH3*TH7*taud3*cos(q2)*cos(q3) + TH3^2*TH7*q2dot^2*cos(q3)^2*sin(q2) + TH2*TH4*TH5*q1dot^2*(sin(q2 + q3) - 3*cos(q2 + q3)^2*sin(q2 + q3)) - TH2*TH4*TH6*q1dot^2*(sin(q2 + q3) - 3*cos(q2 + q3)^2*sin(q2 + q3)) - Bemf3*TH4*TH5*q3dot*cos(q2 + q3) + Bemf3*TH4*TH6*q3dot*cos(q2 + q3) + 2*TH1*TH6^2*q1dot*q2dot*cos(2*q2) - Bemf2*TH6*TH7*q2dot*cos(q2) + Bemf3*TH6*TH7*q3dot*cos(q2) + 2*TH2*TH6^2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*TH6^2*q1dot*q3dot*cos(2*q2 + 2*q3) - TH4*TH5*TH6*q2dot^2*sin(q2 + q3) - TH4*TH5*TH6*q3dot^2*sin(q2 + q3) + TH1*TH6*TH7*q1dot^2*(sin(q2) - 3*cos(q2)^2*sin(q2)) - TH3*TH4*taud2*cos(q2 + q3)*cos(q3) + TH3*TH4*taud3*cos(q2 + q3)*cos(q3) + 2*TH4*TH6^2*q2dot*q3dot*sin(q2 + q3) - TH3^2*TH4*q1dot^2*sin(q2 + q3)^2*cos(q3)*sin(q2) - TH3^2*TH7*q1dot^2*sin(q2 + q3)*cos(q3)*sin(q2)^2 + TH3*TH4*TH5*q1dot^2*sin(q2 + q3)^2*sin(q2) - TH3*TH4*TH6*q1dot^2*sin(q2 + q3)^2*sin(q2) + TH3*TH6*TH7*q1dot^2*sin(q2 + q3)*sin(q2)^2 + 2*TH3^2*TH4*q2dot*q3dot*sin(q2 + q3)*cos(q3)^2 + Bemf2*TH3*TH4*q2dot*cos(q2 + q3)*cos(q3) - Bemf3*TH3*TH4*q3dot*cos(q2 + q3)*cos(q3) + Bemf3*TH3*TH7*q3dot*cos(q2)*cos(q3) - 2*TH1*TH5*TH6*q1dot*q2dot*cos(2*q2) + 2*TH2*TH3^2*q1dot*q2dot*cos(q2 + q3)^2*cos(q3)^2 + 2*TH2*TH3^2*q1dot*q3dot*cos(q2 + q3)^2*cos(q3)^2 - 2*TH2*TH3^2*q1dot*q2dot*sin(q2 + q3)^2*cos(q3)^2 - 2*TH2*TH3^2*q1dot*q3dot*sin(q2 + q3)^2*cos(q3)^2 - TH3^2*TH4*q2dot^2*cos(q2 + q3)*cos(q3)*sin(q3) - TH3^2*TH4*q3dot^2*cos(q2 + q3)*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*q1dot*q2dot*cos(2*q2 + 2*q3) - 2*TH2*TH5*TH6*q1dot*q3dot*cos(2*q2 + 2*q3) + 4*TH3^3*q1dot*q2dot*cos(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3^3*q1dot*q3dot*cos(q2 + q3)*cos(q2)*cos(q3)^2 - TH3*TH4*TH9*cos(q2 + q3)*cos(q2)*cos(q3) - TH3*TH7*TH8*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH1*TH3^2*q1dot*q2dot*cos(q2)^2*cos(q3)^2 - TH3*TH4*TH5*q2dot^2*cos(q2 + q3)*sin(q3) + TH3*TH4*TH6*q2dot^2*cos(q2 + q3)*sin(q3) - 2*TH1*TH3^2*q1dot*q2dot*cos(q3)^2*sin(q2)^2 - 4*TH3^3*q1dot*q2dot*sin(q2 + q3)*cos(q3)^2*sin(q2) - 2*TH3^3*q1dot*q3dot*sin(q2 + q3)*cos(q3)^2*sin(q2) + 4*TH3*TH6^2*q1dot*q2dot*cos(q2 + q3)*cos(q2) + 2*TH3*TH6^2*q1dot*q3dot*cos(q2 + q3)*cos(q2) + TH3^2*TH7*q2dot^2*cos(q2)*cos(q3)*sin(q3) + TH3*TH4*TH9*sin(q2 + q3)*cos(q3)*sin(q2) + TH3*TH7*TH8*sin(q2 + q3)*cos(q3)*sin(q2) - 4*TH3*TH6^2*q1dot*q2dot*sin(q2 + q3)*sin(q2) - 2*TH3*TH6^2*q1dot*q3dot*sin(q2 + q3)*sin(q2) + TH3*TH6*TH7*q2dot^2*cos(q2)*sin(q3) + TH3*TH6*TH7*q3dot^2*cos(q2)*sin(q3) - 2*TH4*TH5*TH6*q2dot*q3dot*sin(q2 + q3) + TH3^2*TH4*q1dot^2*cos(q2 + q3)^2*cos(q3)*sin(q2) + TH3^2*TH7*q1dot^2*sin(q2 + q3)*cos(q2)^2*cos(q3) + TH3^2*TH4*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2)*cos(q3) - 2*TH3*TH4*TH5*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2) + 2*TH3*TH4*TH6*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2) + TH3^2*TH7*q1dot^2*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q2) - 2*TH3*TH6*TH7*q1dot^2*cos(q2 + q3)*cos(q2)*sin(q2) - 2*TH3^2*TH4*q2dot*q3dot*cos(q2 + q3)*cos(q3)*sin(q3) - 4*TH3*TH5*TH6*q1dot*q2dot*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*q1dot*q3dot*cos(q2 + q3)*cos(q2) + 4*TH3*TH5*TH6*q1dot*q2dot*sin(q2 + q3)*sin(q2) + 2*TH3*TH5*TH6*q1dot*q3dot*sin(q2 + q3)*sin(q2) + TH1*TH3*TH4*q1dot^2*sin(q2 + q3)*cos(q2)^2*cos(q3) + TH2*TH3*TH7*q1dot^2*cos(q2 + q3)^2*cos(q3)*sin(q2) + 2*TH3*TH6*TH7*q2dot*q3dot*cos(q2)*sin(q3) - TH1*TH3*TH4*q1dot^2*sin(q2 + q3)*cos(q3)*sin(q2)^2 - TH2*TH3*TH7*q1dot^2*sin(q2 + q3)^2*cos(q3)*sin(q2) + TH2*TH3*TH7*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2)*cos(q3) + TH1*TH3*TH4*q1dot^2*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - (p4*(2*TH1*TH6^2*cos(q2)*sin(q2) - 2*TH6*TH7^2*cos(q2)*sin(q2) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) - 2*TH1*TH5*TH6*cos(q2)*sin(q2) + 2*TH1*TH3^2*cos(q2)*cos(q3)^2*sin(q2) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) + 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q2)*cos(q3))*(TH6^2*taud1 - TH5*TH6*taud1 + TH3^2*taud1*cos(q3)^2 - Bemf1*TH6^2*q1dot - TH6^2*TH7*q2dot^2*cos(q2) + TH4*TH5*taud3*sin(q2 + q3) - TH4*TH6*taud3*sin(q2 + q3) + TH6*TH7*taud2*sin(q2) - TH6*TH7*taud3*sin(q2) + (TH6*TH7*TH9*sin(2*q2))/2 + Bemf1*TH5*TH6*q1dot + (TH4*TH5*TH8*sin(2*q2 + 2*q3))/2 - (TH4*TH6*TH8*sin(2*q2 + 2*q3))/2 - TH4*TH6^2*q2dot^2*cos(q2 + q3) - TH4*TH6^2*q3dot^2*cos(q2 + q3) - Bemf1*TH3^2*q1dot*cos(q3)^2 + TH5*TH6*TH7*q2dot^2*cos(q2) - TH3*TH4*taud2*sin(q2 + q3)*cos(q3) + TH3*TH4*taud3*sin(q2 + q3)*cos(q3) - TH3^2*TH4*q2dot^2*cos(q2 + q3)*cos(q3)^2 - TH3^2*TH4*q3dot^2*cos(q2 + q3)*cos(q3)^2 - TH3*TH7*taud3*cos(q3)*sin(q2) - TH3^2*TH7*q2dot^2*cos(q2)*cos(q3)^2 - Bemf3*TH4*TH5*q3dot*sin(q2 + q3) + Bemf3*TH4*TH6*q3dot*sin(q2 + q3) + TH1*TH6^2*q1dot*q2dot*sin(2*q2) - TH2*TH4*TH5*q1dot^2*(cos(q2 + q3) - cos(q2 + q3)^3) + TH2*TH4*TH6*q1dot^2*(cos(q2 + q3) - cos(q2 + q3)^3) - Bemf2*TH6*TH7*q2dot*sin(q2) + Bemf3*TH6*TH7*q3dot*sin(q2) + TH2*TH6^2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*TH6^2*q1dot*q3dot*sin(2*q2 + 2*q3) + TH4*TH5*TH6*q2dot^2*cos(q2 + q3) + TH4*TH5*TH6*q3dot^2*cos(q2 + q3) - 2*TH4*TH6^2*q2dot*q3dot*cos(q2 + q3) - TH1*TH6*TH7*q1dot^2*(cos(q2) - cos(q2)^3) - TH3*TH4*TH5*q1dot^2*sin(q2 + q3)^2*cos(q2) + TH3*TH4*TH6*q1dot^2*sin(q2 + q3)^2*cos(q2) - TH3*TH6*TH7*q1dot^2*cos(q2 + q3)*sin(q2)^2 - 2*TH3^2*TH4*q2dot*q3dot*cos(q2 + q3)*cos(q3)^2 + Bemf2*TH3*TH4*q2dot*sin(q2 + q3)*cos(q3) - Bemf3*TH3*TH4*q3dot*sin(q2 + q3)*cos(q3) + Bemf3*TH3*TH7*q3dot*cos(q3)*sin(q2) - TH1*TH5*TH6*q1dot*q2dot*sin(2*q2) - TH3^2*TH4*q2dot^2*sin(q2 + q3)*cos(q3)*sin(q3) - TH3^2*TH4*q3dot^2*sin(q2 + q3)*cos(q3)*sin(q3) - TH2*TH5*TH6*q1dot*q2dot*sin(2*q2 + 2*q3) - TH2*TH5*TH6*q1dot*q3dot*sin(2*q2 + 2*q3) + 2*TH3^3*q1dot*q2dot*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*q1dot*q2dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3^3*q1dot*q3dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 - TH3*TH4*TH9*sin(q2 + q3)*cos(q2)*cos(q3) - TH3*TH7*TH8*cos(q2 + q3)*cos(q3)*sin(q2) - TH3*TH4*TH5*q2dot^2*sin(q2 + q3)*sin(q3) + TH3*TH4*TH6*q2dot^2*sin(q2 + q3)*sin(q3) + 2*TH3*TH6^2*q1dot*q2dot*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*q1dot*q2dot*sin(q2 + q3)*cos(q2) + 2*TH3*TH6^2*q1dot*q3dot*sin(q2 + q3)*cos(q2) + TH3^2*TH7*q2dot^2*cos(q3)*sin(q2)*sin(q3) + 2*TH4*TH5*TH6*q2dot*q3dot*cos(q2 + q3) + TH3*TH6*TH7*q2dot^2*sin(q2)*sin(q3) + TH3*TH6*TH7*q3dot^2*sin(q2)*sin(q3) + 2*TH3*TH6*TH7*q2dot*q3dot*sin(q2)*sin(q3) + 2*TH1*TH3^2*q1dot*q2dot*cos(q2)*cos(q3)^2*sin(q2) + TH3^2*TH4*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2) + TH3^2*TH7*q1dot^2*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2) - 2*TH3^2*TH4*q2dot*q3dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3*TH5*TH6*q1dot*q2dot*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*q1dot*q2dot*sin(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*q1dot*q3dot*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*q1dot*q2dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH2*TH3^2*q1dot*q3dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + TH2*TH3*TH7*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2) + TH1*TH3*TH4*q1dot^2*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2;
pdot(3,1)=p6*(((taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + TH0*TH3*sin(q3) + TH1*TH3*cos(q2)^2*sin(q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*sin(q3) + 2*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*sin(q2 + q3)*cos(q2) + TH4*TH7*cos(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*sin(q3) + 2*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH0*TH3*sin(q3) + 2*TH1*TH3*cos(q2)^2*sin(q3) + 2*TH2*TH5*cos(q2 + q3)*sin(q2 + q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*sin(q3) + 4*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*sin(q2 + q3)*cos(q2) + 2*TH4*TH7*cos(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*sin(q3) + 4*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH8*sin(q2 + q3) + TH3*q2dot^2*cos(q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) + TH3*q1dot^2*cos(q2 + q3)*cos(q2))*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(TH4*q2dot^2*sin(q2 + q3) + TH4*q3dot^2*sin(q2 + q3) + 2*TH4*q2dot*q3dot*sin(q2 + q3) + TH3*q1dot*q3dot*cos(q3) + 2*TH3*q1dot*q2dot*cos(2*q2 + q3) + TH3*q1dot*q3dot*cos(2*q2 + q3) + 2*TH2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*q1dot*q3dot*cos(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH8*sin(q2 + q3) - TH3*q3dot^2*cos(q3) + TH3*q1dot^2*cos(2*q2 + q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) - 2*TH3*q2dot*q3dot*cos(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH4*TH5*cos(q2 + q3) - TH4*TH6*cos(q2 + q3) + TH3*TH4*cos(q2 + q3)*cos(q3) - TH3*TH4*sin(q2 + q3)*sin(q3) + TH3*TH7*sin(q2)*sin(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 - ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 + ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2) - p5*(((TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2))*(TH8*sin(q2 + q3) - TH3*q3dot^2*cos(q3) + TH3*q1dot^2*cos(2*q2 + q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) - 2*TH3*q2dot*q3dot*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + TH0*TH3*sin(q3) + TH1*TH3*cos(q2)^2*sin(q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*sin(q3) + 2*TH3^2*sin(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*sin(q2 + q3)*cos(q2) + TH4*TH7*cos(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*sin(q3) + 2*TH2*TH3*cos(q2 + q3)*sin(q2 + q3)*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(TH4*q2dot^2*sin(q2 + q3) + TH4*q3dot^2*sin(q2 + q3) + 2*TH4*q2dot*q3dot*sin(q2 + q3) + TH3*q1dot*q3dot*cos(q3) + 2*TH3*q1dot*q2dot*cos(2*q2 + q3) + TH3*q1dot*q3dot*cos(2*q2 + q3) + 2*TH2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*q1dot*q3dot*cos(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((2*TH4^2*cos(q2 + q3)*sin(q2 + q3) + 2*TH2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3*TH6*sin(q2 + q3)*cos(q2))*(taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH3*TH4*cos(q2 + q3)*cos(q3) - TH3*TH4*sin(q2 + q3)*sin(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH8*sin(q2 + q3) + TH3*q2dot^2*cos(q3) + TH2*q1dot^2*cos(2*q2 + 2*q3) + TH3*q1dot^2*cos(q2 + q3)*cos(q2))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((Bemf3*q3dot - taud3 - TH8*cos(q2 + q3) + TH3*q2dot^2*sin(q3) + (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + TH3*q1dot^2*sin(q2 + q3)*cos(q2))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 - ((TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2))*(taud2 - Bemf2*q2dot + TH8*cos(q2 + q3) + TH9*cos(q2) + TH3*q3dot^2*sin(q3) - TH3*q1dot^2*sin(2*q2 + q3) - (TH1*q1dot^2*sin(2*q2))/2 - (TH2*q1dot^2*sin(2*q2 + 2*q3))/2 + 2*TH3*q2dot*q3dot*sin(q3))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2 + ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(taud1 - Bemf1*q1dot - TH4*q2dot^2*cos(q2 + q3) - TH4*q3dot^2*cos(q2 + q3) - TH7*q2dot^2*cos(q2) + TH2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*q1dot*q3dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*q3dot*cos(q2 + q3) + TH3*q1dot*q3dot*sin(q3) + 2*TH3*q1dot*q2dot*sin(2*q2 + q3) + TH3*q1dot*q3dot*sin(2*q2 + q3) + TH1*q1dot*q2dot*sin(2*q2))*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2) - (p4*(TH4*TH5*taud3*cos(q2 + q3) - TH4*TH6*taud3*cos(q2 + q3) - 2*TH3^2*taud1*cos(q3)*sin(q3) + TH4*TH5*TH8*cos(2*q2 + 2*q3) - TH4*TH6*TH8*cos(2*q2 + 2*q3) + TH4*TH6^2*q2dot^2*sin(q2 + q3) + TH4*TH6^2*q3dot^2*sin(q2 + q3) + TH3*TH4*taud2*sin(q2 + q3)*sin(q3) - TH3*TH4*taud3*sin(q2 + q3)*sin(q3) + TH3^2*TH4*q2dot^2*sin(q2 + q3)*sin(q3)^2 + TH3^2*TH4*q3dot^2*sin(q2 + q3)*sin(q3)^2 + TH3*TH7*taud3*sin(q2)*sin(q3) + TH3^2*TH7*q2dot^2*cos(q3)^2*sin(q2) + TH2*TH4*TH5*q1dot^2*(sin(q2 + q3) - 3*cos(q2 + q3)^2*sin(q2 + q3)) - TH2*TH4*TH6*q1dot^2*(sin(q2 + q3) - 3*cos(q2 + q3)^2*sin(q2 + q3)) - TH3^2*TH7*q2dot^2*sin(q2)*sin(q3)^2 - Bemf3*TH4*TH5*q3dot*cos(q2 + q3) + Bemf3*TH4*TH6*q3dot*cos(q2 + q3) + 2*Bemf1*TH3^2*q1dot*cos(q3)*sin(q3) + 2*TH2*TH6^2*q1dot*q2dot*cos(2*q2 + 2*q3) + 2*TH2*TH6^2*q1dot*q3dot*cos(2*q2 + 2*q3) - TH4*TH5*TH6*q2dot^2*sin(q2 + q3) - TH4*TH5*TH6*q3dot^2*sin(q2 + q3) - TH3*TH4*taud2*cos(q2 + q3)*cos(q3) + TH3*TH4*taud3*cos(q2 + q3)*cos(q3) + 2*TH4*TH6^2*q2dot*q3dot*sin(q2 + q3) - TH3^2*TH4*q1dot^2*sin(q2 + q3)^2*cos(q3)*sin(q2) + TH3*TH6*TH7*q1dot^2*sin(q2 + q3)*sin(q2)^2 + Bemf2*TH3*TH4*q2dot*cos(q2 + q3)*cos(q3) - Bemf3*TH3*TH4*q3dot*cos(q2 + q3)*cos(q3) + 2*TH3^2*TH4*q2dot*q3dot*sin(q2 + q3)*sin(q3)^2 - Bemf2*TH3*TH4*q2dot*sin(q2 + q3)*sin(q3) + Bemf3*TH3*TH4*q3dot*sin(q2 + q3)*sin(q3) + 2*TH2*TH3^2*q1dot*q2dot*cos(q2 + q3)^2*cos(q3)^2 + 2*TH2*TH3^2*q1dot*q3dot*cos(q2 + q3)^2*cos(q3)^2 - Bemf3*TH3*TH7*q3dot*sin(q2)*sin(q3) - 2*TH2*TH3^2*q1dot*q2dot*sin(q2 + q3)^2*cos(q3)^2 - 2*TH2*TH3^2*q1dot*q3dot*sin(q2 + q3)^2*cos(q3)^2 + TH3^2*TH4*q2dot^2*cos(q2 + q3)*cos(q3)*sin(q3) + TH3^2*TH4*q3dot^2*cos(q2 + q3)*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*q1dot*q2dot*cos(2*q2 + 2*q3) - 2*TH2*TH5*TH6*q1dot*q3dot*cos(2*q2 + 2*q3) + 2*TH3^3*q1dot*q2dot*cos(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3^3*q1dot*q3dot*cos(q2 + q3)*cos(q2)*cos(q3)^2 - TH3*TH4*TH9*cos(q2 + q3)*cos(q2)*cos(q3) - TH3*TH4*TH5*q2dot^2*cos(q2 + q3)*sin(q3) - TH3*TH4*TH5*q2dot^2*sin(q2 + q3)*cos(q3) + TH3*TH4*TH6*q2dot^2*cos(q2 + q3)*sin(q3) + TH3*TH4*TH6*q2dot^2*sin(q2 + q3)*cos(q3) - 2*TH3^3*q1dot*q2dot*sin(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3*TH6^2*q1dot*q2dot*cos(q2 + q3)*cos(q2) + 2*TH3*TH6^2*q1dot*q3dot*cos(q2 + q3)*cos(q2) + 2*TH3^2*TH7*q2dot^2*cos(q2)*cos(q3)*sin(q3) + TH3*TH4*TH9*sin(q2 + q3)*cos(q2)*sin(q3) + TH3*TH7*TH8*cos(q2 + q3)*sin(q2)*sin(q3) + TH3*TH7*TH8*sin(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH6^2*q1dot*q2dot*sin(q2 + q3)*sin(q2) + TH3*TH6*TH7*q2dot^2*cos(q3)*sin(q2) + TH3*TH6*TH7*q3dot^2*cos(q3)*sin(q2) - 2*TH4*TH5*TH6*q2dot*q3dot*sin(q2 + q3) + TH3^2*TH4*q1dot^2*cos(q2 + q3)^2*cos(q3)*sin(q2) - 4*TH3^3*q1dot*q2dot*cos(q2 + q3)*cos(q3)*sin(q2)*sin(q3) - 4*TH3^3*q1dot*q2dot*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q3) - 4*TH3^3*q1dot*q3dot*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q3) - TH3^2*TH4*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*sin(q2)*sin(q3) - 2*TH3*TH4*TH5*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2) + 2*TH3*TH4*TH6*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q2) + TH3^2*TH7*q1dot^2*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q2) - TH3^2*TH7*q1dot^2*sin(q2 + q3)*cos(q2)*sin(q2)*sin(q3) + 2*TH3^2*TH4*q2dot*q3dot*cos(q2 + q3)*cos(q3)*sin(q3) - 2*TH3*TH5*TH6*q1dot*q2dot*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*q1dot*q3dot*cos(q2 + q3)*cos(q2) + 2*TH3*TH5*TH6*q1dot*q2dot*sin(q2 + q3)*sin(q2) + TH2*TH3*TH7*q1dot^2*cos(q2 + q3)^2*cos(q3)*sin(q2) + 2*TH3*TH6*TH7*q2dot*q3dot*cos(q3)*sin(q2) - TH2*TH3*TH7*q1dot^2*sin(q2 + q3)^2*cos(q3)*sin(q2) - TH2*TH3*TH7*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*sin(q2)*sin(q3) - 4*TH2*TH3^2*q1dot*q2dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q3) - 4*TH2*TH3^2*q1dot*q3dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q3) + TH1*TH3*TH4*q1dot^2*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q2) - TH1*TH3*TH4*q1dot^2*sin(q2 + q3)*cos(q2)*sin(q2)*sin(q3) - 4*TH1*TH3^2*q1dot*q2dot*cos(q2)*cos(q3)*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - (p4*(2*TH0*TH3^2*cos(q3)*sin(q3) + 2*TH2*TH6^2*cos(q2 + q3)*sin(q2 + q3) - 2*TH4^2*TH5*cos(q2 + q3)*sin(q2 + q3) + 2*TH4^2*TH6*cos(q2 + q3)*sin(q2 + q3) + 2*TH3^3*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)^2*cos(q3)*sin(q3) + 4*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)*sin(q3) + 2*TH1*TH3^2*cos(q2)^2*cos(q3)*sin(q3) - 2*TH2*TH5*TH6*cos(q2 + q3)*sin(q2 + q3) - 2*TH3*TH5*TH6*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH4*TH7*cos(q2 + q3)*cos(q3)*sin(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*sin(q2)*sin(q3))*(TH6^2*taud1 - TH5*TH6*taud1 + TH3^2*taud1*cos(q3)^2 - Bemf1*TH6^2*q1dot - TH6^2*TH7*q2dot^2*cos(q2) + TH4*TH5*taud3*sin(q2 + q3) - TH4*TH6*taud3*sin(q2 + q3) + TH6*TH7*taud2*sin(q2) - TH6*TH7*taud3*sin(q2) + (TH6*TH7*TH9*sin(2*q2))/2 + Bemf1*TH5*TH6*q1dot + (TH4*TH5*TH8*sin(2*q2 + 2*q3))/2 - (TH4*TH6*TH8*sin(2*q2 + 2*q3))/2 - TH4*TH6^2*q2dot^2*cos(q2 + q3) - TH4*TH6^2*q3dot^2*cos(q2 + q3) - Bemf1*TH3^2*q1dot*cos(q3)^2 + TH5*TH6*TH7*q2dot^2*cos(q2) - TH3*TH4*taud2*sin(q2 + q3)*cos(q3) + TH3*TH4*taud3*sin(q2 + q3)*cos(q3) - TH3^2*TH4*q2dot^2*cos(q2 + q3)*cos(q3)^2 - TH3^2*TH4*q3dot^2*cos(q2 + q3)*cos(q3)^2 - TH3*TH7*taud3*cos(q3)*sin(q2) - TH3^2*TH7*q2dot^2*cos(q2)*cos(q3)^2 - Bemf3*TH4*TH5*q3dot*sin(q2 + q3) + Bemf3*TH4*TH6*q3dot*sin(q2 + q3) + TH1*TH6^2*q1dot*q2dot*sin(2*q2) - TH2*TH4*TH5*q1dot^2*(cos(q2 + q3) - cos(q2 + q3)^3) + TH2*TH4*TH6*q1dot^2*(cos(q2 + q3) - cos(q2 + q3)^3) - Bemf2*TH6*TH7*q2dot*sin(q2) + Bemf3*TH6*TH7*q3dot*sin(q2) + TH2*TH6^2*q1dot*q2dot*sin(2*q2 + 2*q3) + TH2*TH6^2*q1dot*q3dot*sin(2*q2 + 2*q3) + TH4*TH5*TH6*q2dot^2*cos(q2 + q3) + TH4*TH5*TH6*q3dot^2*cos(q2 + q3) - 2*TH4*TH6^2*q2dot*q3dot*cos(q2 + q3) - TH1*TH6*TH7*q1dot^2*(cos(q2) - cos(q2)^3) - TH3*TH4*TH5*q1dot^2*sin(q2 + q3)^2*cos(q2) + TH3*TH4*TH6*q1dot^2*sin(q2 + q3)^2*cos(q2) - TH3*TH6*TH7*q1dot^2*cos(q2 + q3)*sin(q2)^2 - 2*TH3^2*TH4*q2dot*q3dot*cos(q2 + q3)*cos(q3)^2 + Bemf2*TH3*TH4*q2dot*sin(q2 + q3)*cos(q3) - Bemf3*TH3*TH4*q3dot*sin(q2 + q3)*cos(q3) + Bemf3*TH3*TH7*q3dot*cos(q3)*sin(q2) - TH1*TH5*TH6*q1dot*q2dot*sin(2*q2) - TH3^2*TH4*q2dot^2*sin(q2 + q3)*cos(q3)*sin(q3) - TH3^2*TH4*q3dot^2*sin(q2 + q3)*cos(q3)*sin(q3) - TH2*TH5*TH6*q1dot*q2dot*sin(2*q2 + 2*q3) - TH2*TH5*TH6*q1dot*q3dot*sin(2*q2 + 2*q3) + 2*TH3^3*q1dot*q2dot*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*q1dot*q2dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3^3*q1dot*q3dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 - TH3*TH4*TH9*sin(q2 + q3)*cos(q2)*cos(q3) - TH3*TH7*TH8*cos(q2 + q3)*cos(q3)*sin(q2) - TH3*TH4*TH5*q2dot^2*sin(q2 + q3)*sin(q3) + TH3*TH4*TH6*q2dot^2*sin(q2 + q3)*sin(q3) + 2*TH3*TH6^2*q1dot*q2dot*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*q1dot*q2dot*sin(q2 + q3)*cos(q2) + 2*TH3*TH6^2*q1dot*q3dot*sin(q2 + q3)*cos(q2) + TH3^2*TH7*q2dot^2*cos(q3)*sin(q2)*sin(q3) + 2*TH4*TH5*TH6*q2dot*q3dot*cos(q2 + q3) + TH3*TH6*TH7*q2dot^2*sin(q2)*sin(q3) + TH3*TH6*TH7*q3dot^2*sin(q2)*sin(q3) + 2*TH3*TH6*TH7*q2dot*q3dot*sin(q2)*sin(q3) + 2*TH1*TH3^2*q1dot*q2dot*cos(q2)*cos(q3)^2*sin(q2) + TH3^2*TH4*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2) + TH3^2*TH7*q1dot^2*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2) - 2*TH3^2*TH4*q2dot*q3dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3*TH5*TH6*q1dot*q2dot*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*q1dot*q2dot*sin(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*q1dot*q3dot*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*q1dot*q2dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH2*TH3^2*q1dot*q3dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + TH2*TH3*TH7*q1dot^2*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2) + TH1*TH3*TH4*q1dot^2*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))^2;
pdot(4,1)=taud1 - p1 + taud2 + taud3 - p5*(((2*TH3*q1dot*sin(2*q2 + q3) + TH1*q1dot*sin(2*q2) + TH2*q1dot*sin(2*q2 + 2*q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH2*q1dot*sin(2*q2 + 2*q3) + 2*TH3*q1dot*sin(q2 + q3)*cos(q2))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(TH3*q3dot*sin(q3) - Bemf1 + 2*TH3*q2dot*sin(2*q2 + q3) + TH3*q3dot*sin(2*q2 + q3) + TH1*q2dot*sin(2*q2) + TH2*q2dot*sin(2*q2 + 2*q3) + TH2*q3dot*sin(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) + p6*(((2*TH3*q1dot*sin(2*q2 + q3) + TH1*q1dot*sin(2*q2) + TH2*q1dot*sin(2*q2 + 2*q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH2*q1dot*sin(2*q2 + 2*q3) + 2*TH3*q1dot*sin(q2 + q3)*cos(q2))*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(TH3*q3dot*sin(q3) - Bemf1 + 2*TH3*q2dot*sin(2*q2 + q3) + TH3*q3dot*sin(2*q2 + q3) + TH1*q2dot*sin(2*q2) + TH2*q2dot*sin(2*q2 + 2*q3) + TH2*q3dot*sin(2*q2 + 2*q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) - (p4*(Bemf1*TH5*TH6 - Bemf1*TH6^2 - Bemf1*TH3^2*cos(q3)^2 + TH1*TH6^2*q2dot*sin(2*q2) + TH2*TH6^2*q2dot*sin(2*q2 + 2*q3) + TH2*TH6^2*q3dot*sin(2*q2 + 2*q3) - TH1*TH5*TH6*q2dot*sin(2*q2) - 2*TH2*TH4*TH5*q1dot*(cos(q2 + q3) - cos(q2 + q3)^3) + 2*TH2*TH4*TH6*q1dot*(cos(q2 + q3) - cos(q2 + q3)^3) - TH2*TH5*TH6*q2dot*sin(2*q2 + 2*q3) - TH2*TH5*TH6*q3dot*sin(2*q2 + 2*q3) + 2*TH3^3*q2dot*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*q2dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3^3*q3dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*q2dot*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*q2dot*sin(q2 + q3)*cos(q2) + 2*TH3*TH6^2*q3dot*sin(q2 + q3)*cos(q2) - 2*TH1*TH6*TH7*q1dot*(cos(q2) - cos(q2)^3) - 2*TH3*TH5*TH6*q2dot*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*q2dot*sin(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*q3dot*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*q2dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH2*TH3^2*q3dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 - 2*TH3*TH4*TH5*q1dot*sin(q2 + q3)^2*cos(q2) + 2*TH3*TH4*TH6*q1dot*sin(q2 + q3)^2*cos(q2) - 2*TH3*TH6*TH7*q1dot*cos(q2 + q3)*sin(q2)^2 + 2*TH1*TH3^2*q2dot*cos(q2)*cos(q3)^2*sin(q2) + 2*TH3^2*TH7*q1dot*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2) + 2*TH3^2*TH4*q1dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2) + 2*TH1*TH3*TH4*q1dot*sin(q2 + q3)*cos(q2)*cos(q3)*sin(q2) + 2*TH2*TH3*TH7*q1dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2));
pdot(5,1)=taud1 - p2 + taud2 + taud3 - p5*(((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(2*TH3*q1dot*sin(2*q2 + q3) + TH1*q1dot*sin(2*q2) + TH2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*cos(q2 + q3) - 2*TH4*q3dot*cos(q2 + q3) - 2*TH7*q2dot*cos(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf2 - 2*TH3*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - (2*TH3*q2dot*sin(q3)*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) + p6*(((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(2*TH3*q1dot*sin(2*q2 + q3) + TH1*q1dot*sin(2*q2) + TH2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*cos(q2 + q3) - 2*TH4*q3dot*cos(q2 + q3) - 2*TH7*q2dot*cos(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((Bemf2 - 2*TH3*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - (2*TH3*q2dot*sin(q3)*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) - (p4*(TH1*TH6^2*q1dot*sin(2*q2) - Bemf2*TH6*TH7*sin(q2) + TH2*TH6^2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*TH6^2*q2dot*cos(q2 + q3) - 2*TH4*TH6^2*q3dot*cos(q2 + q3) - 2*TH6^2*TH7*q2dot*cos(q2) - TH1*TH5*TH6*q1dot*sin(2*q2) - TH2*TH5*TH6*q1dot*sin(2*q2 + 2*q3) + 2*TH3^3*q1dot*cos(q2 + q3)*cos(q3)^2*sin(q2) + 2*TH3^3*q1dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*q1dot*cos(q2 + q3)*sin(q2) + 2*TH3*TH6^2*q1dot*sin(q2 + q3)*cos(q2) + 2*TH4*TH5*TH6*q2dot*cos(q2 + q3) + 2*TH4*TH5*TH6*q3dot*cos(q2 + q3) + 2*TH5*TH6*TH7*q2dot*cos(q2) - 2*TH3^2*TH4*q2dot*cos(q2 + q3)*cos(q3)^2 - 2*TH3^2*TH4*q3dot*cos(q2 + q3)*cos(q3)^2 + Bemf2*TH3*TH4*sin(q2 + q3)*cos(q3) - 2*TH3^2*TH7*q2dot*cos(q2)*cos(q3)^2 - 2*TH3^2*TH4*q2dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3^2*TH4*q3dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3*TH5*TH6*q1dot*cos(q2 + q3)*sin(q2) - 2*TH3*TH5*TH6*q1dot*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*q1dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 - 2*TH3*TH4*TH5*q2dot*sin(q2 + q3)*sin(q3) + 2*TH3*TH4*TH6*q2dot*sin(q2 + q3)*sin(q3) + 2*TH3^2*TH7*q2dot*cos(q3)*sin(q2)*sin(q3) + 2*TH3*TH6*TH7*q2dot*sin(q2)*sin(q3) + 2*TH3*TH6*TH7*q3dot*sin(q2)*sin(q3) + 2*TH1*TH3^2*q1dot*cos(q2)*cos(q3)^2*sin(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2));
pdot(6,1)=taud1 - p3 + taud2 + taud3 + p5*((Bemf3*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3))*(TH3*q1dot*sin(q3) + TH3*q1dot*sin(2*q2 + q3) + TH2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*cos(q2 + q3) - 2*TH4*q3dot*cos(q2 + q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + ((2*TH3*q2dot*sin(q3) + 2*TH3*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + 2*TH3*TH6*cos(q2 + q3)*cos(q2)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) - p6*(((2*TH3*q2dot*sin(q3) + 2*TH3*q3dot*sin(q3))*(TH0*TH6 - TH4^2*sin(q2 + q3)^2 + TH2*TH6*cos(q2 + q3)^2 + TH1*TH6*cos(q2)^2 + TH0*TH3*cos(q3) + TH1*TH3*cos(q2)^2*cos(q3) + 2*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH6*cos(q2 + q3)*cos(q2) - TH4*TH7*sin(q2 + q3)*sin(q2) + TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) + (Bemf3*(TH0*TH5 - TH4^2*sin(q2 + q3)^2 - TH7^2*sin(q2)^2 + TH2*TH5*cos(q2 + q3)^2 + TH1*TH5*cos(q2)^2 + 2*TH0*TH3*cos(q3) + 2*TH1*TH3*cos(q2)^2*cos(q3) + 4*TH3^2*cos(q2 + q3)*cos(q2)*cos(q3) + 2*TH3*TH5*cos(q2 + q3)*cos(q2) - 2*TH4*TH7*sin(q2 + q3)*sin(q2) + 2*TH2*TH3*cos(q2 + q3)^2*cos(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2)) - ((TH4*TH6*sin(q2 + q3) - TH4*TH5*sin(q2 + q3) + TH6*TH7*sin(q2) - TH3*TH4*sin(q2 + q3)*cos(q3) + TH3*TH7*cos(q3)*sin(q2))*(TH3*q1dot*sin(q3) + TH3*q1dot*sin(2*q2 + q3) + TH2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*q2dot*cos(q2 + q3) - 2*TH4*q3dot*cos(q2 + q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2))) - (p4*(Bemf3*TH6*TH7*sin(q2) + TH2*TH6^2*q1dot*sin(2*q2 + 2*q3) - 2*TH4*TH6^2*q2dot*cos(q2 + q3) - 2*TH4*TH6^2*q3dot*cos(q2 + q3) - Bemf3*TH4*TH5*sin(q2 + q3) + Bemf3*TH4*TH6*sin(q2 + q3) + Bemf3*TH3*TH7*cos(q3)*sin(q2) - TH2*TH5*TH6*q1dot*sin(2*q2 + 2*q3) + 2*TH3^3*q1dot*sin(q2 + q3)*cos(q2)*cos(q3)^2 + 2*TH3*TH6^2*q1dot*sin(q2 + q3)*cos(q2) + 2*TH4*TH5*TH6*q2dot*cos(q2 + q3) + 2*TH4*TH5*TH6*q3dot*cos(q2 + q3) - 2*TH3^2*TH4*q2dot*cos(q2 + q3)*cos(q3)^2 - 2*TH3^2*TH4*q3dot*cos(q2 + q3)*cos(q3)^2 - Bemf3*TH3*TH4*sin(q2 + q3)*cos(q3) - 2*TH3^2*TH4*q2dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3^2*TH4*q3dot*sin(q2 + q3)*cos(q3)*sin(q3) - 2*TH3*TH5*TH6*q1dot*sin(q2 + q3)*cos(q2) + 2*TH2*TH3^2*q1dot*cos(q2 + q3)*sin(q2 + q3)*cos(q3)^2 + 2*TH3*TH6*TH7*q2dot*sin(q2)*sin(q3) + 2*TH3*TH6*TH7*q3dot*sin(q2)*sin(q3)))/(TH0*TH6^2 - TH0*TH5*TH6 + TH2*TH6^2*cos(q2 + q3)^2 + TH4^2*TH5*sin(q2 + q3)^2 - TH4^2*TH6*sin(q2 + q3)^2 + TH0*TH3^2*cos(q3)^2 + TH1*TH6^2*cos(q2)^2 + TH6*TH7^2*sin(q2)^2 - TH2*TH5*TH6*cos(q2 + q3)^2 - TH1*TH5*TH6*cos(q2)^2 + TH2*TH3^2*cos(q2 + q3)^2*cos(q3)^2 + 2*TH3^3*cos(q2 + q3)*cos(q2)*cos(q3)^2 + TH1*TH3^2*cos(q2)^2*cos(q3)^2 + 2*TH3*TH6^2*cos(q2 + q3)*cos(q2) - 2*TH3*TH5*TH6*cos(q2 + q3)*cos(q2) - 2*TH3*TH4*TH7*sin(q2 + q3)*cos(q3)*sin(q2));
 